import { CalculatorContent } from '@/types/calculator';

export const portlandHomeEnergyScoreContent: CalculatorContent = {
  meta: {
    title: 'Portland Home Energy Score Cost Calculator | Oregon HES Requirements',
    description: 'Calculate Portland Home Energy Score (HES) costs, assessment fees, improvement recommendations, and ROI for selling homes in Oregon. Required for home sales in Portland.',
  },
  title: 'Portland (OR) "Home Energy Score" Cost',
  description: 'Calculate the cost and value of Portland\'s required Home Energy Score',
  icon: 'Zap',
  category: 'State-Specific Tools',
  subcategory: 'Location Analysis',
  article: {
    title: 'Portland Home Energy Score: Requirements, Costs, and Benefits',
    content: `
# Portland Home Energy Score (HES) Calculator

## Overview

Portland, Oregon requires a Home Energy Score (HES) report for most home sales. Understanding the costs, requirements, and potential return on investment helps sellers budget effectively and make strategic improvements.

## What is a Home Energy Score?

The Home Energy Score is a national rating system developed by the U.S. Department of Energy that provides a standardized assessment of a home's energy efficiency.

### Score Range
- **Scale**: 1 to 10 (10 is most efficient)
- **National Median**: Score of 5
- **Portland Average**: Score of 4-5
- **New Construction**: Typically scores 7-9

### Assessment Components
- **Home Envelope**: Insulation, air sealing, windows
- **Heating/Cooling Systems**: HVAC efficiency and maintenance
- **Water Heating**: Tank type, efficiency, insulation
- **Foundation**: Basement and crawlspace conditions

## Portland HES Requirements

### When Required
- **Home Sales**: Required at time of listing (with exceptions)
- **Multifamily**: Buildings with 1-4 units
- **Timeline**: Must be completed within 6 months of listing
- **Disclosure**: Report must be provided to potential buyers

### Exemptions
- **New Construction**: Homes less than 2 years old
- **Recent Assessment**: Valid HES within 10 years
- **Hardship**: Financial hardship exemption available
- **Demolition**: Property sold for land value only
- **Foreclosure**: Bank-owned properties may be exempt

## Assessment Process and Costs

### HES Assessment Fee
- **Single-Family Home**: $200-$350
- **Larger Homes** (>3,000 sq ft): $350-$500
- **Multifamily** (2-4 units): $300-$600
- **Rush Service**: Additional $50-$100

### Assessment Duration
- **On-Site Visit**: 60-90 minutes
- **Report Delivery**: 5-7 business days
- **Expedited**: 48-hour delivery available

### What's Included
- **Energy Score** (1-10 scale)
- **Improvement Recommendations**: Prioritized list
- **Cost Estimates**: For recommended upgrades
- **Savings Projections**: Annual energy cost reductions
- **Utility Rebate Information**: Available incentives

## Common Improvement Recommendations

### High-Impact Upgrades
**Attic Insulation** (R-38 to R-49)
- Cost: $1,500-$3,000
- Annual Savings: $200-$400
- Payback Period: 5-8 years
- Score Improvement: +0.5 to +1.0

**Air Sealing**
- Cost: $500-$1,500
- Annual Savings: $150-$300
- Payback Period: 3-5 years
- Score Improvement: +0.3 to +0.7

**HVAC Upgrade** (to 95% AFUE furnace)
- Cost: $4,000-$7,000
- Annual Savings: $300-$600
- Payback Period: 10-15 years
- Score Improvement: +0.5 to +1.2

**Window Replacement** (double to triple pane)
- Cost: $8,000-$20,000
- Annual Savings: $200-$500
- Payback Period: 20-40 years
- Score Improvement: +0.5 to +1.0

### Medium-Impact Upgrades
**Water Heater Upgrade** (to heat pump)
- Cost: $2,500-$4,500
- Annual Savings: $200-$350
- Payback Period: 8-12 years
- Score Improvement: +0.3 to +0.5

**Duct Sealing**
- Cost: $500-$1,200
- Annual Savings: $100-$250
- Payback Period: 4-7 years
- Score Improvement: +0.2 to +0.4

**Crawlspace Insulation**
- Cost: $1,500-$3,500
- Annual Savings: $150-$300
- Payback Period: 6-10 years
- Score Improvement: +0.3 to +0.6

## Financial Incentives

### Energy Trust of Oregon Rebates
- **Attic Insulation**: Up to $1,000 rebate
- **Heat Pump Water Heater**: Up to $600 rebate
- **Ductless Heat Pump**: Up to $1,500 rebate
- **Weatherization**: Up to $500 rebate

### Federal Tax Credits
- **Heat Pumps**: 30% of cost (up to $2,000)
- **Insulation**: 30% of cost (up to $1,200)
- **Windows**: 30% of cost (up to $600)
- **Energy Audit**: 30% of cost (up to $150)

### Utility Programs
- **Portland General Electric**: $50-$500 per upgrade
- **Pacific Power**: $100-$1,000 per upgrade
- **NW Natural**: $25-$750 for gas appliances

## Impact on Home Sales

### Market Value Considerations
**Higher Score (7-10)**
- Premium: 1-3% higher sale price
- Days on Market: 10-20% faster sale
- Buyer Confidence: Reduced inspection concerns

**Average Score (4-6)**
- Neutral: Minimal impact on price
- Standard Timeline: Normal market conditions
- Disclosure: Baseline expectation met

**Lower Score (1-3)**
- Discount Risk: May reduce offers 2-5%
- Extended Market Time: Buyers may hesitate
- Negotiating Tool: Buyers request credits or upgrades

### Seller Strategies

**Pre-Listing Improvements**
- Make high-ROI upgrades before assessment
- Target improvements that boost score most
- Complete work before listing for maximum impact

**Disclosure with Context**
- Explain recent upgrades not reflected in score
- Provide receipts for efficiency improvements
- Highlight utility bill savings

**Buyer Incentives**
- Offer credit for improvements
- Provide contractor referrals
- Share rebate information

## Cost-Benefit Analysis by Home Type

### Older Home (Pre-1960)
- **Typical Score**: 2-4
- **Assessment Cost**: $300
- **Recommended Upgrades**: $8,000-$15,000
- **Potential Score**: 5-7 (after upgrades)
- **ROI**: 60-90% on efficiency upgrades

### Mid-Century Home (1960-1990)
- **Typical Score**: 3-5
- **Assessment Cost**: $250
- **Recommended Upgrades**: $4,000-$8,000
- **Potential Score**: 6-8 (after upgrades)
- **ROI**: 70-100% on efficiency upgrades

### Recent Home (1990-2010)
- **Typical Score**: 5-7
- **Assessment Cost**: $200
- **Recommended Upgrades**: $2,000-$5,000
- **Potential Score**: 7-9 (after upgrades)
- **ROI**: 80-120% on efficiency upgrades

## Compliance and Penalties

### Non-Compliance Consequences
- **Initial Notice**: 30 days to comply
- **Citation**: $500 penalty
- **Continued Violation**: $500 per month
- **Sale Contingency**: Transaction may be delayed

### Enforcement
- **Complaint-Based**: Triggered by buyer or third party
- **Random Audits**: Rare but possible
- **MLS Verification**: Some listing services check compliance

## How to Use This Tool

1. **Enter Home Details**: Size, age, and current features
2. **Select Assessment Type**: Standard or expedited
3. **Review Cost Estimate**: Assessment and improvement costs
4. **Evaluate Improvements**: Prioritize upgrades by ROI
5. **Calculate Net Benefit**: Compare costs to sale price impact
6. **Plan Timeline**: Schedule assessment and improvements

This tool helps Portland homeowners understand the Home Energy Score requirement, plan for assessment costs, and evaluate energy efficiency improvements for maximum return on investment.
    `,
    keywords: [
      'Portland Home Energy Score',
      'Oregon HES',
      'Portland home selling requirements',
      'energy audit Portland',
      'HES cost',
      'Portland energy efficiency',
      'home energy assessment Oregon',
      'Portland home improvements',
      'energy score Portland',
      'Oregon home sale requirements',
    ],
  },
  variables: {
    homeSize: {
      label: 'Home Size (square feet)',
      type: 'number',
      defaultValue: 2000,
      min: 500,
      max: 10000,
      step: 100,
      helpText: 'Total living space square footage',
    },
    homeAge: {
      label: 'Home Age',
      type: 'select',
      defaultValue: '1960-1990',
      options: [
        { value: 'pre-1960', label: 'Pre-1960' },
        { value: '1960-1990', label: '1960-1990' },
        { value: '1990-2010', label: '1990-2010' },
        { value: 'post-2010', label: 'Post-2010' },
      ],
      helpText: 'Age range of your home',
    },
    currentInsulation: {
      label: 'Current Attic Insulation',
      type: 'select',
      defaultValue: 'minimal',
      options: [
        { value: 'none', label: 'None or Minimal (R-0 to R-19)' },
        { value: 'minimal', label: 'Below Code (R-20 to R-30)' },
        { value: 'adequate', label: 'Adequate (R-31 to R-38)' },
        { value: 'excellent', label: 'Excellent (R-39+)' },
      ],
      helpText: 'Current attic insulation level',
    },
    hvacAge: {
      label: 'HVAC System Age',
      type: 'select',
      defaultValue: '10-20',
      options: [
        { value: '0-5', label: '0-5 years (Modern)' },
        { value: '5-10', label: '5-10 years (Good)' },
        { value: '10-20', label: '10-20 years (Aging)' },
        { value: '20+', label: '20+ years (Replace Soon)' },
      ],
      helpText: 'Age of heating and cooling system',
    },
    windows: {
      label: 'Window Type',
      type: 'select',
      defaultValue: 'double-pane',
      options: [
        { value: 'single-pane', label: 'Single-Pane' },
        { value: 'double-pane', label: 'Double-Pane' },
        { value: 'triple-pane', label: 'Triple-Pane or Low-E' },
      ],
      helpText: 'Current window type',
    },
    waterHeater: {
      label: 'Water Heater Type',
      type: 'select',
      defaultValue: 'standard-tank',
      options: [
        { value: 'old-tank', label: 'Old Tank (>10 years)' },
        { value: 'standard-tank', label: 'Standard Tank (<10 years)' },
        { value: 'tankless', label: 'Tankless/On-Demand' },
        { value: 'heat-pump', label: 'Heat Pump Water Heater' },
      ],
      helpText: 'Type of water heating system',
    },
    expeditedService: {
      label: 'Expedited Assessment?',
      type: 'select',
      defaultValue: 'no',
      options: [
        { value: 'no', label: 'No (Standard 5-7 days)' },
        { value: 'yes', label: 'Yes (48-hour delivery)' },
      ],
      helpText: 'Need rushed assessment?',
    },
    planImprovements: {
      label: 'Plan Pre-Sale Improvements?',
      type: 'select',
      defaultValue: 'moderate',
      options: [
        { value: 'none', label: 'No improvements' },
        { value: 'minimal', label: 'Minimal ($1,000-3,000)' },
        { value: 'moderate', label: 'Moderate ($3,000-8,000)' },
        { value: 'comprehensive', label: 'Comprehensive ($8,000+)' },
      ],
      helpText: 'Budget for energy improvements',
    },
  },
  calculate: (inputs) => {
    const homeSize = inputs.homeSize || 2000;
    const homeAge = inputs.homeAge || '1960-1990';
    const currentInsulation = inputs.currentInsulation || 'minimal';
    const hvacAge = inputs.hvacAge || '10-20';
    const windows = inputs.windows || 'double-pane';
    const waterHeater = inputs.waterHeater || 'standard-tank';
    const expeditedService = inputs.expeditedService || 'no';
    const planImprovements = inputs.planImprovements || 'moderate';

    // Base assessment cost
    let assessmentCost = 250;
    if (homeSize > 3000) assessmentCost = 400;
    else if (homeSize > 2500) assessmentCost = 325;
    
    if (expeditedService === 'yes') assessmentCost += 75;

    // Estimate current score
    let estimatedScore = 5; // baseline

    // Adjustments based on features
    if (homeAge === 'pre-1960') estimatedScore -= 1.5;
    if (homeAge === '1960-1990') estimatedScore -= 0.5;
    if (homeAge === 'post-2010') estimatedScore += 1.5;

    if (currentInsulation === 'none') estimatedScore -= 1.0;
    if (currentInsulation === 'minimal') estimatedScore -= 0.5;
    if (currentInsulation === 'excellent') estimatedScore += 1.0;

    if (hvacAge === '20+') estimatedScore -= 1.0;
    if (hvacAge === '10-20') estimatedScore -= 0.5;
    if (hvacAge === '0-5') estimatedScore += 0.5;

    if (windows === 'single-pane') estimatedScore -= 1.0;
    if (windows === 'triple-pane') estimatedScore += 0.5;

    if (waterHeater === 'old-tank') estimatedScore -= 0.5;
    if (waterHeater === 'heat-pump') estimatedScore += 1.0;
    if (waterHeater === 'tankless') estimatedScore += 0.5;

    // Cap between 1-10
    estimatedScore = Math.max(1, Math.min(10, estimatedScore));

    // Calculate improvement costs
    let improvementCost = 0;
    let scoreIncrease = 0;

    if (planImprovements === 'minimal') {
      improvementCost = 2000;
      scoreIncrease = 0.5;
    } else if (planImprovements === 'moderate') {
      improvementCost = 5500;
      scoreIncrease = 1.0;
    } else if (planImprovements === 'comprehensive') {
      improvementCost = 12000;
      scoreIncrease = 2.0;
    }

    const projectedScore = Math.min(10, estimatedScore + scoreIncrease);

    // Estimate annual energy savings
    const currentAnnualCost = 2000 + (homeSize * 0.5); // baseline energy cost
    const savingsPercentage = scoreIncrease * 0.08; // 8% savings per score point
    const annualSavings = currentAnnualCost * savingsPercentage;

    // Rebates available
    let availableRebates = 0;
    if (planImprovements === 'minimal') availableRebates = 300;
    if (planImprovements === 'moderate') availableRebates = 1200;
    if (planImprovements === 'comprehensive') availableRebates = 2500;

    // Net improvement cost after rebates
    const netImprovementCost = Math.max(0, improvementCost - availableRebates);

    // Payback period (years)
    const paybackPeriod = annualSavings > 0 ? netImprovementCost / annualSavings : 0;

    // Total cost to seller
    const totalCost = assessmentCost + netImprovementCost;

    // Estimated sale price impact
    let salePriceImpact = 0;
    if (projectedScore >= 7) salePriceImpact = 0.02; // 2% premium
    else if (projectedScore >= 5) salePriceImpact = 0;
    else salePriceImpact = -0.03; // 3% discount risk

    return {
      results: {
        assessmentCost: {
          label: 'HES Assessment Cost',
          value: assessmentCost,
          type: 'currency' as const,
        },
        estimatedScore: {
          label: 'Estimated Current Score',
          value: estimatedScore,
          type: 'number' as const,
          precision: 1,
        },
        improvementCost: {
          label: 'Improvement Cost (before rebates)',
          value: improvementCost,
          type: 'currency' as const,
        },
        availableRebates: {
          label: 'Estimated Rebates & Incentives',
          value: availableRebates,
          type: 'currency' as const,
        },
        netImprovementCost: {
          label: 'Net Improvement Cost',
          value: netImprovementCost,
          type: 'currency' as const,
        },
        projectedScore: {
          label: 'Projected Score (after improvements)',
          value: projectedScore,
          type: 'number' as const,
          precision: 1,
        },
        annualSavings: {
          label: 'Estimated Annual Energy Savings',
          value: annualSavings,
          type: 'currency' as const,
        },
        paybackPeriod: {
          label: 'Payback Period (years)',
          value: paybackPeriod,
          type: 'number' as const,
          precision: 1,
        },
        totalCost: {
          label: 'Total Cost to Seller',
          value: totalCost,
          type: 'currency' as const,
        },
        salePriceImpact: {
          label: 'Est. Sale Price Impact',
          value: salePriceImpact * 100,
          type: 'percentage' as const,
        },
      },
    };
  },
};
