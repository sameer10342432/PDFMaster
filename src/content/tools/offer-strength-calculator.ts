import { CalculatorContent } from "@/types";

export const OFFER_STRENGTH_CALCULATOR_CONTENT: CalculatorContent = {
  title: "Offer Strength Calculator | Home Offer Competitiveness Score",
  description:
    "Calculate how competitive your home offer is by weighing price, contingencies, closing timeline, and other terms. Win in multiple offer situations with strategic offers.",
  icon: "Icon",
  category: "Calculators",
  slug: "offer-strength-calculator",
  article: {
    title: "Offer Strength Calculator: Win the Home You Want",
    content: `
# Offer Strength Calculator: How to Win in Competitive Markets

In competitive real estate markets, the highest price doesn't always win. Smart buyers create winning offers by optimizing multiple factors beyond just price. This tool helps you build the strongest possible offer for your dream home.

## What Makes an Offer Strong?

A strong offer balances:
1. **Price** - Competitive with market value
2. **Contingencies** - Fewer = stronger offer
3. **Closing Timeline** - Flexibility wins
4. **Earnest Money** - Shows commitment
5. **Financing** - Pre-approval strength
6. **Personal Appeal** - Seller connection
7. **Flexibility** - Meeting seller needs

## Key Offer Components

### 1. Offer Price (Weight: 40%)
**Most important factor but not the only one!**

- **At asking**: Baseline competitive
- **1-5% over asking**: Moderately competitive
- **6-10% over asking**: Highly competitive
- **11%+ over asking**: Extremely competitive (or overpriced market)

**Strategic pricing**:
- Offer asking price minimum in hot markets
- Round numbers (psychological appeal)
- Beat competitive offers by odd amounts ($301,000 vs $300,000)
- Know comps to avoid overpaying

### 2. Contingencies (Weight: 25%)
**Fewer contingencies = stronger offer**

**Common contingencies**:
- **Inspection** (10-day): Standard protection
- **Financing** (30-day): Required unless cash
- **Appraisal** (included in financing): Protects you but weakens offer
- **Home sale** (60+ days): Very weak, avoid if possible

**Contingency strategies**:
- **Waive inspection**: Risky! Only for new construction or pre-inspected homes
- **Informational inspection only**: Still inspect but can't back out
- **Appraisal gap coverage**: Agree to cover $X if appraisal low
- **Waive home sale**: Sell first or rent back your current home

### 3. Earnest Money Deposit (Weight: 10%)
**Shows financial commitment**

- **Standard**: 1-2% of purchase price
- **Strong**: 3-5% of purchase price
- **Very strong**: 5-10% of purchase price

**Example**:
- $400,000 home
- Standard: $4,000-8,000
- Strong: $12,000-20,000
- Very strong: $20,000-40,000

**Note**: You get this back at closing; it counts toward down payment

### 4. Closing Timeline (Weight: 15%)
**Flexibility shows strength**

**Typical timelines**:
- **Cash**: 7-14 days possible
- **Conventional**: 30-45 days
- **FHA/VA**: 45-60 days

**Seller preferences**:
- **Quick close**: Sellers who need to move fast
- **Delayed close**: Sellers who need time to find new home
- **Rent-back**: Sellers who want to stay temporarily

**Strategic approach**:
- Ask seller's preferred timeline
- Offer flexibility: "Can close any time between 30-60 days per seller preference"
- Rent-back option: Allow seller to stay 30-60 days post-closing

### 5. Financing Type (Weight: 10%)
**Stronger financing = more confident sellers**

**Strength ranking**:
1. **Cash** (100% strength): No financing contingency
2. **Conventional 20%+ down** (90% strength): Most reliable financing
3. **Conventional <20% down** (80% strength): Requires PMI
4. **FHA** (70% strength): More requirements
5. **VA** (75% strength): Benefits but VA appraisal stricter
6. **USDA** (65% strength): Rural only, income limits

**Boost financing strength**:
- Get pre-approval (not just pre-qualification)
- Provide proof of funds for down payment
- Letter from lender confirming readiness
- Underwriter reviewed file

## Competitive Offer Strategies

### Strategy 1: The All-Cash Equivalent
**For financed buyers competing with cash**

Make your financed offer look like cash:
- Waive appraisal contingency (risky!)
- Or offer appraisal gap coverage up to $X
- Short inspection period (5 days not 10)
- Large earnest money deposit (5-10%)
- Lender's strong pre-approval letter
- Quick closing timeline (21-30 days)

### Strategy 2: The Seller-Friendly Approach
**Win by making seller's life easy**

- Flexible closing date
- Rent-back option if needed
- Cover some seller closing costs
- "As-is" offer (waive repair requests)
- Free lease-back for 30-60 days
- Take unwanted items (furniture, appliances)

### Strategy 3: The Escalation Clause
**Automatic competition killer**

"I offer $400,000 and will beat any competing offer by $2,000, up to maximum of $425,000"

**Pros**:
- Automatically competitive
- Don't overpay if no competition
- Shows strong intent

**Cons**:
- Seller knows your maximum
- May still lose to better terms
- Needs proper documentation

### Strategy 4: The Personal Touch
**Emotional connection**

- Write heartfelt letter to sellers
- Share why you love the home
- Include family photo
- Explain your plans for the home
- Connect on shared interests

**Warning**: Some states ban this to prevent discrimination

### Strategy 5: The Clean Offer
**Simplicity wins**

- No strange contingencies
- Standard forms and timelines
- Professional presentation
- Quick response time
- Decisive negotiation

## Offer Strength Score System

**100-point scale:**

**Price (40 points maximum)**:
- At asking: 30 points
- 1-5% over: 33-37 points
- 6-10% over: 38-40 points
- 11%+ over: 40 points
- Below asking: 20-29 points

**Contingencies (25 points maximum)**:
- No contingencies: 25 points
- Inspection only: 20 points
- Inspection + financing: 15 points
- Inspection + financing + appraisal: 10 points
- Inspection + financing + home sale: 5 points

**Earnest Money (10 points maximum)**:
- 5-10%: 10 points
- 3-5%: 8 points
- 1-3%: 5 points
- <1%: 2 points

**Closing Timeline (15 points maximum)**:
- Seller's ideal timeline: 15 points
- Flexible (seller chooses): 12 points
- Standard timeline: 10 points
- Inconvenient timeline: 5 points

**Financing (10 points maximum)**:
- Cash: 10 points
- Conventional 20%+ down: 9 points
- Conventional <20% down: 7 points
- VA: 7 points
- FHA: 6 points
- USDA: 5 points

**Total Score:**
- 90-100: Elite offer (very likely to win)
- 80-89: Strong offer (competitive)
- 70-79: Moderate offer (decent chance)
- 60-69: Weak offer (unlikely to win in competition)
- Below 60: Very weak offer (needs major improvements)

## Common Offer Mistakes

### Mistake #1: Lowballing in Hot Markets
**Problem**: Wastes everyone's time, offends sellers
**Solution**: Offer at or above asking in competitive markets

### Mistake #2: Too Many Contingencies
**Problem**: Gives you too many exit options, scares sellers
**Solution**: Only include necessary protections

### Mistake #3: Unrealistic Timelines
**Problem**: Promises you can't keep create trust issues
**Solution**: Be honest about what you can deliver

### Mistake #4: Weak Pre-Approval
**Problem**: Sellers doubt your ability to close
**Solution**: Get underwriter-reviewed pre-approval

### Mistake #5: Ignoring Seller Motivations
**Problem**: One-size-fits-all offers lose
**Solution**: Ask about seller's needs and preferences

### Mistake #6: Over-Emotional Decision
**Problem**: Overpay or waive important protections
**Solution**: Set maximum price and stick to it

## How to Research Offer Competitiveness

### 1. Ask the Listing Agent
"What terms are most important to the seller?"
"What's the typical closing timeline sellers prefer?"
"How much earnest money is standard?"

### 2. Check Market Stats
- Average days on market in area
- List price to sale price ratio
- Number of offers typical homes get
- Recent comparable sales

### 3. Review Disclosure Documents
Seller disclosures may hint at:
- Needed repairs (inform contingency decisions)
- Timeline pressures
- Home history

### 4. Observe Showing Activity
- Lots of showings = likely multiple offers
- Open house crowds = higher competition
- Quick showings schedule = motivated seller

## When to Walk Away

Even strong offers should have limits:

**Walk away if:**
- Exceeds your true budget
- Requires waiving protections you need
- Sellers are unreasonable in negotiations
- Appraisal comes in very low and seller won't budge
- Inspection reveals major undisclosed issues
- Gut feeling says something's wrong

**Remember**: There will always be another house!

## Multiple Offer Situations

### Best and Highest
**What it means**:
"Submit your best offer by 5pm Monday"

**How to respond**:
- This IS your final offer
- Go to your maximum comfortable price
- Optimize all non-price terms
- Don't expect counter-offer
- Be prepared to walk away

### Highest and Best
**What it means**:
Often same as above, but emphasizes price

**How to respond**:
- Price is most important
- But still optimize other terms
- Include escalation clause if comfortable

### Counter-Offer to Multiple Buyers
**What it means**:
Seller shopping your terms against others

**How to respond**:
- Improve your offer if you can
- Add escalation clause
- Shorten timelines
- Don't get into bidding war beyond comfort

## Using This Calculator

**Input your offer details**:
1. Offer price vs listing price
2. Contingencies included
3. Earnest money deposit
4. Closing timeline
5. Financing type
6. Special terms

**Get your results**:
1. **Offer Strength Score** (0-100)
2. **Competitiveness Rating** (Weak to Elite)
3. **Improvement Suggestions**
4. **Risk Assessment**
5. **Win Probability Estimate**

## Final Tips

### Do:
âœ… Get strongest pre-approval possible
âœ… Respond quickly to all communications
âœ… Be flexible on non-critical terms
âœ… Show financial strength
âœ… Make clean, professional offer
âœ… Write personal letter (where allowed)
âœ… Trust your agent's advice

### Don't:
âŒ Make emotional decisions
âŒ Waive protections you truly need
âŒ Exceed your budget
âŒ Play games or lowball
âŒ Be inflexible on everything
âŒ Ignore seller motivations
âŒ Submit incomplete offers

The strongest offer isn't always the highest priceâ€”it's the one that best meets the seller's needs while protecting your interests. Use this calculator to find that sweet spot and win your dream home!
    `,
  },
  calculator: {
    fields: [
      {
        name: "listingPrice",
        label: "Listing Price ($)",
        type: "number",
        defaultValue: "400000",
      },
      {
        name: "offerPrice",
        label: "Your Offer Price ($)",
        type: "number",
        defaultValue: "410000",
      },
      {
        name: "earnestMoneyPercent",
        label: "Earnest Money (% of offer)",
        type: "number",
        defaultValue: "3",
      },
      {
        name: "contingencies",
        label: "Contingencies Included",
        type: "select",
        options: [
          { value: "none-as-is-cash", label: "None (as-is, cash)" },
          { value: "inspection-only", label: "Inspection only" },
          { value: "inspection-financing", label: "Inspection + Financing" },
          { value: "inspection-financing-appraisal", label: "Inspection + Financing + Appraisal" },
          { value: "inspection-financing-home-sale", label: "Inspection + Financing + Home Sale" }
        ],
        defaultValue: "inspection-financing",
      },
      {
        name: "financingType",
        label: "Financing Type",
        type: "select",
        options: [
          { value: "cash", label: "Cash" },
          { value: "conventional-20-plus-down", label: "Conventional 20%+ down" },
          { value: "conventional-less-20-down", label: "Conventional <20% down" },
          { value: "fha", label: "FHA" },
          { value: "va", label: "VA" },
          { value: "usda", label: "USDA" }
        ],
        defaultValue: "conventional-20-plus-down",
      },
      {
        name: "closingTimeline",
        label: "Closing Timeline",
        type: "select",
        options: [
          { value: "sellers-choice-flexible", label: "Seller's choice (flexible)" },
          { value: "7-14-days-cash", label: "7-14 days (cash)" },
          { value: "21-30-days", label: "21-30 days" },
          { value: "31-45-days", label: "31-45 days" },
          { value: "46-60-days", label: "46-60 days" },
          { value: "60-plus-days", label: "60+ days" }
        ],
        defaultValue: "31-45-days",
      },
      {
        name: "rentBack",
        label: "Offering Rent-Back?",
        type: "select",
        options: [
          { value: "yes", label: "Yes" },
          { value: "no", label: "No" }
        ],
        defaultValue: "no",
      },
    ],
    results: [
      {
        label: "Offer Strength Score",
        isCurrency: false,
      },
      {
        label: "Competitiveness Rating",
        isCurrency: false,
      },
      {
        label: "Price Competitiveness",
        isCurrency: false,
      },
      {
        label: "Terms Strength",
        isCurrency: false,
      },
      {
        label: "Win Probability",
        isCurrency: false,
      },
      {
        label: "Improvement Suggestions",
        isCurrency: false,
      },
    ],
    calculate: (values) => {
      const {
        listingPrice,
        offerPrice,
        earnestMoneyPercent,
        contingencies,
        financingType,
        closingTimeline,
        rentBack,
      } = values;

      const listing = parseFloat(listingPrice);
      const offer = parseFloat(offerPrice);
      const earnest = parseFloat(earnestMoneyPercent);

      // Calculate price score (40 points max)
      const pricePercentage = ((offer - listing) / listing) * 100;
      let priceScore = 30;
      if (pricePercentage >= 11) priceScore = 40;
      else if (pricePercentage >= 6) priceScore = 38;
      else if (pricePercentage >= 3) priceScore = 35;
      else if (pricePercentage >= 0) priceScore = 30;
      else if (pricePercentage >= -3) priceScore = 25;
      else priceScore = 20;

      // Calculate contingency score (25 points max)
      let contingencyScore = 15;
      if (contingencies === "none-as-is-cash") contingencyScore = 25;
      else if (contingencies === "inspection-only") contingencyScore = 20;
      else if (contingencies === "inspection-financing") contingencyScore = 15;
      else if (contingencies === "inspection-financing-appraisal") contingencyScore = 10;
      else contingencyScore = 5;

      // Calculate earnest money score (10 points max)
      let earnestScore = 5;
      if (earnest >= 5) earnestScore = 10;
      else if (earnest >= 3) earnestScore = 8;
      else if (earnest >= 1) earnestScore = 5;
      else earnestScore = 2;

      // Calculate closing timeline score (15 points max)
      let timelineScore = 10;
      if (closingTimeline === "sellers-choice-flexible") timelineScore = 15;
      else if (closingTimeline === "7-14-days-cash") timelineScore = 14;
      else if (closingTimeline === "21-30-days") timelineScore = 12;
      else if (closingTimeline === "31-45-days") timelineScore = 10;
      else if (closingTimeline === "46-60-days") timelineScore = 8;
      else timelineScore = 5;

      // Calculate financing score (10 points max)
      let financingScore = 7;
      if (financingType === "cash") financingScore = 10;
      else if (financingType === "conventional-20-plus-down") financingScore = 9;
      else if (financingType === "conventional-less-20-down") financingScore = 7;
      else if (financingType === "va") financingScore = 7;
      else if (financingType === "fha") financingScore = 6;
      else financingScore = 5;

      // Bonus for rent-back
      const rentBackBonus = rentBack === "yes" ? 2 : 0;

      const totalScore = priceScore + contingencyScore + earnestScore + timelineScore + financingScore + rentBackBonus;

      let rating = "";
      let winProbability = "";
      if (totalScore >= 90) {
        rating = "ðŸ† ELITE OFFER - Extremely competitive, very likely to win";
        winProbability = "90-95% in competitive situations";
      } else if (totalScore >= 80) {
        rating = "â­ STRONG OFFER - Highly competitive, good chance to win";
        winProbability = "70-85% in competitive situations";
      } else if (totalScore >= 70) {
        rating = "âœ“ MODERATE OFFER - Competitive, decent chance";
        winProbability = "50-65% in competitive situations";
      } else if (totalScore >= 60) {
        rating = "âš ï¸ WEAK OFFER - Below average, needs improvement";
        winProbability = "30-45% in competitive situations";
      } else {
        rating = "âŒ VERY WEAK OFFER - Unlikely to win, major changes needed";
        winProbability = "10-25% in competitive situations";
      }

      let priceComp = "";
      if (pricePercentage >= 10) priceComp = `Excellent! ${pricePercentage.toFixed(1)}% above asking`;
      else if (pricePercentage >= 5) priceComp = `Strong! ${pricePercentage.toFixed(1)}% above asking`;
      else if (pricePercentage >= 0) priceComp = `Fair. At asking price`;
      else priceComp = `Weak. ${Math.abs(pricePercentage).toFixed(1)}% below asking`;

      let termsStrength = "";
      if (contingencyScore >= 20) termsStrength = "Very strong terms - minimal contingencies";
      else if (contingencyScore >= 15) termsStrength = "Moderate terms - standard contingencies";
      else termsStrength = "Weak terms - too many contingencies";

      let suggestions = "ðŸŽ¯ Improvement Suggestions:\n\n";
      if (priceScore < 35) suggestions += "â€¢ Increase offer price to at least asking price or above\n";
      if (contingencyScore < 20) suggestions += "â€¢ Reduce contingencies if comfortable (consider inspection-only or as-is)\n";
      if (earnestScore < 8) suggestions += "â€¢ Increase earnest money to 3-5% to show stronger commitment\n";
      if (timelineScore < 12) suggestions += "â€¢ Offer flexible closing timeline or seller's preferred dates\n";
      if (financingScore < 9 && financingType !== "cash") suggestions += "â€¢ Get strongest pre-approval possible, consider conventional financing\n";
      if (rentBack === "no") suggestions += "â€¢ Consider offering rent-back option to make seller's transition easier\n";
      
      if (totalScore >= 90) {
        suggestions = "âœ… Excellent offer! Your terms are very competitive. Only minor refinements possible:\n\nâ€¢ You're in great position to win\nâ€¢ Stay firm in negotiations\nâ€¢ Be prepared to move quickly\nâ€¢ Have backup plan if you don't win";
      }

      return [
        {
          label: "Offer Strength Score",
          value: `${totalScore.toFixed(0)}/100`,
          isCurrency: false,
        },
        {
          label: "Competitiveness Rating",
          value: rating,
          isCurrency: false,
        },
        {
          label: "Price Competitiveness",
          value: priceComp,
          isCurrency: false,
        },
        {
          label: "Terms Strength",
          value: termsStrength,
          isCurrency: false,
        },
        {
          label: "Win Probability",
          value: winProbability,
          isCurrency: false,
        },
        {
          label: "Improvement Suggestions",
          value: suggestions,
          isCurrency: false,
        },
      ];
    },
  },
};
