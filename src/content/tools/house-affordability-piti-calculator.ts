import { CalculatorContent } from "@/types";

export const HOUSE_AFFORDABILITY_PITI_CALCULATOR_CONTENT: CalculatorContent = {
  title: "How Much House Can I Afford Calculator | PITI + Utilities + Real Costs",
  description:
    "Calculate how much house you can really afford including PITI (Principal, Interest, Taxes, Insurance), HOA fees, utilities, maintenance, and all hidden homeownership costs.",
  icon: "Icon",
  category: "Calculators",
  slug: "house-affordability-piti-calculator",
  article: {
    title: "How Much House Can You REALLY Afford? Complete PITI Analysis",
    content: `
# How Much House Can I *Really* Afford? The Complete Cost Calculator

Most home affordability calculators only show you what a lender will approve—not what you can actually afford while maintaining your lifestyle. This calculator reveals the true cost of homeownership including all expenses most buyers forget.

## Why Most Affordability Calculators Are Wrong

Traditional calculators only consider:
- Monthly mortgage payment (P&I)
- Property taxes
- Homeowners insurance

They ignore:
- Utilities (often $200-500/month)
- Maintenance and repairs (1-3% of home value annually)
- HOA fees
- PMI (if down payment < 20%)
- Homeowners association special assessments
- Lawn care and landscaping
- Pest control
- Higher utility costs in larger homes
- Furnishing costs

## What is PITI?

PITI represents the four main components of your monthly housing payment:

### P - Principal
The amount you pay toward the actual loan balance each month. This builds equity in your home.

### I - Interest
The cost of borrowing money from the lender. This doesn't build equity—it's pure cost.

### T - Taxes
Property taxes vary widely by location:
- **Low tax states**: 0.3-0.7% annually (Hawaii, Alabama, Louisiana)
- **Average tax states**: 0.8-1.5% annually (most states)
- **High tax states**: 1.6-2.5% annually (New Jersey, Illinois, Texas, New Hampshire)

### I - Insurance
Homeowners insurance protects your property:
- **National average**: $1,200-2,000/year
- **High-risk areas** (flood, hurricane, earthquake): $3,000-8,000+/year
- **Condos**: Often cheaper ($500-1,000/year)
- **Luxury homes**: Significantly more expensive

## The REAL Costs of Homeownership

### Beyond PITI: Hidden Monthly Costs

**1. Utilities (Average: $200-500/month)**
- Electricity: $80-200
- Gas/Heating: $40-150
- Water/Sewer: $50-100
- Trash: $15-40
- Internet: $50-100

Larger homes = higher utility costs!

**2. Maintenance (1-3% of home value annually)**
- $300,000 home = $3,000-9,000/year = $250-750/month
- HVAC servicing and eventual replacement
- Roof repairs/replacement (every 15-30 years)
- Appliance replacements
- Plumbing and electrical issues
- Exterior painting
- Driveway and walkway repairs

**3. HOA Fees (if applicable)**
- $100-700/month typical
- Can increase annually
- Special assessments for major repairs
- Not tax-deductible (unlike mortgage interest)

**4. PMI (Private Mortgage Insurance)**
- Required if down payment < 20%
- 0.5-1.5% of loan amount annually
- $100-300/month on $300,000 loan
- Can be removed once you reach 20-22% equity

**5. Additional Costs**
- Lawn care/landscaping: $50-200/month
- Pest control: $30-100/month
- Homeowners association assessments
- Higher insurance with pool, trampoline, etc.
- Security system monitoring: $30-60/month

## The 28/36 Rule (Traditional Guideline)

Lenders traditionally use:
- **28% Rule**: Housing costs ≤ 28% of gross income
- **36% Rule**: Total debt ≤ 36% of gross income

**Example**: $100,000 annual income
- Maximum housing: $2,333/month (28%)
- Maximum total debt: $3,000/month (36%)

**Problem**: This doesn't account for:
- High cost of living areas
- Student loans
- Childcare costs
- Retirement savings goals
- Emergency fund building
- Quality of life expenses

## The REALISTIC Affordability Formula

### Calculate Your True Budget

**1. Calculate Net Income**
Gross income - taxes - benefits = take-home pay

**2. List All Fixed Expenses**
- Car payments
- Student loans
- Credit card minimums
- Childcare
- Insurance premiums
- Phone bills
- Subscriptions

**3. Determine Savings Goals**
- Emergency fund: 3-6 months expenses
- Retirement: At least 15% of income
- College savings
- Other goals

**4. Calculate Lifestyle Costs**
- Groceries
- Dining out
- Entertainment
- Hobbies
- Travel
- Clothing
- Personal care

**5. What's Left = Housing Budget**
True affordable housing = Take-home pay - (fixed + savings + lifestyle)

## Common Affordability Mistakes

### 1. Maxing Out Loan Approval
**Lenders approve**: What you *could* pay
**You should borrow**: What's comfortable

Getting approved for $500k doesn't mean you should buy a $500k house!

### 2. Forgetting About Lifestyle
Don't want to be "house poor":
- Can't afford vacations
- Skip retirement contributions
- No emergency fund
- Constant money stress

### 3. Underestimating Maintenance
Rule of thumb: 1-3% of home value annually
- Newer homes: 1%
- 20-30 year old homes: 2%
- Older homes: 3% or more

**Reality check**: A $400,000 home could need:
- New roof: $10,000-25,000
- HVAC replacement: $5,000-15,000
- Water heater: $1,000-3,000
- Appliances: $500-3,000 each

### 4. Ignoring Location Costs
Two identical houses, different locations:
- Different property tax rates
- Different utility costs
- Different maintenance costs (climate)
- Different HOA fees
- Different insurance costs

## Smart Affordability Strategies

### 1. The 25% Take-Home Pay Rule
Conservative approach:
- Keep TOTAL housing costs ≤ 25% of NET (take-home) income
- Provides cushion for life changes
- Allows savings and lifestyle spending
- Reduces financial stress

### 2. The 50/30/20 Budget
- 50%: Needs (including housing)
- 30%: Wants
- 20%: Savings and debt payoff

**Housing should be largest portion of "needs" but not all of it!**

### 3. Test Drive the Payment
Before buying:
1. Calculate total monthly cost
2. Subtract current rent
3. Put difference in savings for 6 months
4. If difficult = house too expensive

### 4. Consider Future Changes
Will your situation change?
- Job change or loss potential
- Family growth
- Return to school
- Starting a business
- Retirement timeline
- Health issues

## How Much House Can YOU Afford?

### Income Scenarios

**$50,000/year income**
- 28% rule: $1,167/month
- Realistic with all costs: $800-1,000/month
- Home price range: $120,000-180,000

**$75,000/year income**
- 28% rule: $1,750/month
- Realistic with all costs: $1,200-1,500/month
- Home price range: $180,000-250,000

**$100,000/year income**
- 28% rule: $2,333/month
- Realistic with all costs: $1,600-2,000/month
- Home price range: $250,000-350,000

**$150,000/year income**
- 28% rule: $3,500/month
- Realistic with all costs: $2,500-3,200/month
- Home price range: $400,000-550,000

*Note: Assumes 20% down payment and current interest rates*

## Down Payment Considerations

### 20% Down (Ideal)
- No PMI required
- Better interest rates
- More equity from day one
- Stronger offer in competitive markets
- Lower monthly payments

### Less Than 20% Down
- PMI required (adds $100-300/month)
- Higher interest rate possible
- Less equity protection
- Riskier in down market
- But allows earlier homeownership

### First-Time Buyer Programs
- FHA: 3.5% down
- VA: 0% down (for veterans)
- USDA: 0% down (rural areas)
- State programs: Vary by location
- First-time buyer grants

## Location Impact on Affordability

### High Cost of Living Areas
San Francisco, New York, Los Angeles, Seattle, Boston
- Higher prices
- Higher property taxes
- Higher insurance
- Higher utilities
- Need higher income for same lifestyle

### Medium Cost of Living
Most suburban and mid-size cities
- Moderate prices
- Average taxes
- Standard costs
- Better affordability

### Low Cost of Living
Rural areas, small cities, Midwest/South
- Lower prices
- Lower taxes (usually)
- Lower utilities
- Lower insurance
- Better affordability

## How to Increase Affordability

### 1. Improve Credit Score
640 → 740 can save $200+/month on a $300,000 mortgage

### 2. Increase Down Payment
20% down eliminates PMI (saves $100-300/month)

### 3. Pay Off Debt
Lower DTI ratio = can afford more house

### 4. Increase Income
Side hustles, promotion, job change

### 5. Choose Different Location
Commute 15 minutes further → save $50,000-100,000+

### 6. Buy Smaller or Older
1,500 sq ft vs 2,000 sq ft = significant savings

### 7. Look for Fixer-Uppers
Sweat equity can build wealth (if you're handy)

## Red Flags You're Buying Too Much House

- Emergency fund takes years to rebuild
- Can't afford 20% down payment
- Stretching to make payments
- No money for furniture/repairs
- Would be devastated by small income drop
- Can't save for retirement
- Sacrificing all lifestyle spending
- Need second job to afford payments
- Stressed about finances constantly

## Using This Calculator

This calculator shows you:
1. **Lender Approval Amount**: What bank will loan you
2. **True Monthly Cost**: PITI + all real costs
3. **Recommended Budget**: Based on conservative ratios
4. **Quality of Life Impact**: Can you afford your lifestyle?
5. **Emergency Fund Timeline**: How long to rebuild savings

**Enter your real numbers** for accurate results:
- Actual gross income
- All debts
- Real savings rate you want
- Honest lifestyle costs
- Location-specific taxes/insurance

The house you can "afford" should allow you to:
- ✅ Save for retirement
- ✅ Maintain emergency fund
- ✅ Enjoy life (vacations, hobbies, dining out)
- ✅ Handle unexpected repairs
- ✅ Weather income disruptions
- ✅ Sleep well at night

Remember: Just because you're approved for a certain amount doesn't mean you should borrow it. Buy what you can truly afford while maintaining financial health and quality of life!
    `,
  },
  calculator: {
    fields: [
      {
        name: "annualIncome",
        label: "Annual Gross Income ($)",
        type: "number",
        defaultValue: "100000",
      },
      {
        name: "monthlyDebts",
        label: "Monthly Debt Payments (car, student loans, credit cards) ($)",
        type: "number",
        defaultValue: "500",
      },
      {
        name: "downPaymentPercent",
        label: "Down Payment (%)",
        type: "number",
        defaultValue: "20",
      },
      {
        name: "interestRate",
        label: "Interest Rate (%)",
        type: "number",
        defaultValue: "7",
      },
      {
        name: "propertyTaxRate",
        label: "Annual Property Tax Rate (%)",
        type: "number",
        defaultValue: "1.2",
      },
      {
        name: "homeInsurance",
        label: "Annual Home Insurance ($)",
        type: "number",
        defaultValue: "1500",
      },
      {
        name: "hoaFees",
        label: "Monthly HOA Fees (if applicable) ($)",
        type: "number",
        defaultValue: "0",
      },
      {
        name: "utilities",
        label: "Estimated Monthly Utilities ($)",
        type: "number",
        defaultValue: "300",
      },
      {
        name: "maintenancePercent",
        label: "Annual Maintenance (% of home value)",
        type: "number",
        defaultValue: "1.5",
      },
    ],
    results: [
      {
        label: "Maximum Home Price (28% Rule)",
        isCurrency: true,
      },
      {
        label: "Recommended Home Price (Conservative)",
        isCurrency: true,
      },
      {
        label: "Monthly PITI Payment",
        isCurrency: true,
      },
      {
        label: "Total Monthly Costs (Including Utilities & Maintenance)",
        isCurrency: true,
      },
      {
        label: "Annual Housing Costs",
        isCurrency: true,
      },
      {
        label: "Housing Cost % of Income",
        isCurrency: false,
      },
      {
        label: "Recommendation",
        isCurrency: false,
      },
    ],
    calculate: (values) => {
      const {
        annualIncome,
        monthlyDebts,
        downPaymentPercent,
        interestRate,
        propertyTaxRate,
        homeInsurance,
        hoaFees,
        utilities,
        maintenancePercent,
      } = values;

      const income = parseFloat(annualIncome);
      const debts = parseFloat(monthlyDebts);
      const downPct = parseFloat(downPaymentPercent) / 100;
      const rate = parseFloat(interestRate) / 100 / 12;
      const taxRate = parseFloat(propertyTaxRate) / 100;
      const insurance = parseFloat(homeInsurance);
      const hoa = parseFloat(hoaFees);
      const util = parseFloat(utilities);
      const maintPct = parseFloat(maintenancePercent) / 100;

      const monthlyIncome = income / 12;
      const maxHousingPayment = monthlyIncome * 0.28;
      const maxTotalDebt = monthlyIncome * 0.36;
      const availableForHousing = maxTotalDebt - debts;

      // Calculate affordable home price using 28% rule
      const monthsInYear = 12;
      const loanTermMonths = 360; // 30 years
      
      // Work backwards from max payment to find home price
      let estimatedPrice = 300000;
      let iterations = 0;
      
      while (iterations < 100) {
        const loanAmount = estimatedPrice * (1 - downPct);
        const monthlyPI = loanAmount * (rate * Math.pow(1 + rate, loanTermMonths)) / (Math.pow(1 + rate, loanTermMonths) - 1);
        const monthlyTax = (estimatedPrice * taxRate) / 12;
        const monthlyInsurance = insurance / 12;
        const pitiPayment = monthlyPI + monthlyTax + monthlyInsurance + hoa;
        
        if (Math.abs(pitiPayment - maxHousingPayment) < 10) break;
        
        if (pitiPayment > maxHousingPayment) {
          estimatedPrice -= 1000;
        } else {
          estimatedPrice += 1000;
        }
        iterations++;
      }

      const maxPrice = estimatedPrice;
      const recommendedPrice = maxPrice * 0.75; // Conservative: 75% of max

      // Calculate actual costs for recommended price
      const loanAmount = recommendedPrice * (1 - downPct);
      const monthlyPI = loanAmount * (rate * Math.pow(1 + rate, loanTermMonths)) / (Math.pow(1 + rate, loanTermMonths) - 1);
      const monthlyTax = (recommendedPrice * taxRate) / 12;
      const monthlyInsurance = insurance / 12;
      const monthlyPITI = monthlyPI + monthlyTax + monthlyInsurance + hoa;
      
      const monthlyMaintenance = (recommendedPrice * maintPct) / 12;
      const totalMonthlyCost = monthlyPITI + util + monthlyMaintenance;
      const annualHousingCost = totalMonthlyCost * 12;
      const housingPercentage = ((totalMonthlyCost / monthlyIncome) * 100).toFixed(1);

      let recommendation = "";
      const pct = parseFloat(housingPercentage);
      
      if (pct <= 25) {
        recommendation = "✅ EXCELLENT - Your housing costs are very comfortable. You'll have plenty left for savings, lifestyle, and emergencies.";
      } else if (pct <= 30) {
        recommendation = "✅ GOOD - Your housing costs are manageable. You should still be able to save and enjoy life.";
      } else if (pct <= 35) {
        recommendation = "⚠️ MODERATE - Housing costs are getting tight. Budget carefully for other expenses and emergencies.";
      } else if (pct <= 40) {
        recommendation = "⚠️ STRETCHING - You're spending a lot on housing. May struggle with savings and unexpected costs.";
      } else {
        recommendation = "❌ TOO MUCH - Housing costs are too high. You'll likely be house poor. Consider a less expensive home.";
      }

      const pmiNote = downPct < 0.2 ? " Note: Add PMI (~$" + Math.round(loanAmount * 0.01 / 12) + "/mo) if down payment < 20%" : "";

      return [
        {
          label: "Maximum Home Price (28% Rule)",
          value: maxPrice.toFixed(2),
          isCurrency: true,
        },
        {
          label: "Recommended Home Price (Conservative)",
          value: recommendedPrice.toFixed(2),
          isCurrency: true,
        },
        {
          label: "Monthly PITI Payment",
          value: monthlyPITI.toFixed(2) + pmiNote,
          isCurrency: false,
        },
        {
          label: "Total Monthly Costs (Including Utilities & Maintenance)",
          value: totalMonthlyCost.toFixed(2),
          isCurrency: true,
        },
        {
          label: "Annual Housing Costs",
          value: annualHousingCost.toFixed(2),
          isCurrency: true,
        },
        {
          label: "Housing Cost % of Income",
          value: housingPercentage + "%",
          isCurrency: false,
        },
        {
          label: "Recommendation",
          value: recommendation,
          isCurrency: false,
        },
      ];
    },
  },
};
