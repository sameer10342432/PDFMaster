import { CalculatorContent } from '@/types';

export const SUBJECT_TO_DEAL_ANALYZER_CONTENT: CalculatorContent = {
  title: '"Subject-To" Deal Analyzer - Creative Financing Calculator',
  description: 'Analyze subject-to real estate deals where you acquire property while leaving existing mortgage in place',
  icon: 'Icon',
  slug: 'subject-to-deal-analyzer',
  category: 'Investment Analysis',
  article: {
    title: 'Complete Guide to Subject-To Real Estate Investing',
    content: `
    <h2>What is a "Subject-To" Deal?</h2>
    <p>Subject-To (or "Sub-To") is a creative financing strategy where you purchase a property "subject to" the existing mortgage - taking ownership of the property while leaving the seller's mortgage in place. You take over making payments, but the loan stays in the seller's name. This allows you to acquire properties with little or no money down and no bank qualification.</p>

    <h3>How Subject-To Transactions Work</h3>
    <ul>
      <li><strong>Deed Transfer:</strong> Seller deeds the property to you - you become the legal owner.</li>
      <li><strong>Mortgage Stays in Place:</strong> Existing mortgage remains in seller's name - you make the payments.</li>
      <li><strong>Payment Agreement:</strong> You agree to make all mortgage payments, property taxes, and insurance.</li>
      <li><strong>Equity Payment:</strong> You pay seller for their equity (often in installments or at refinance).</li>
      <li><strong>No Bank Qualifying:</strong> You don't need to qualify for a new loan - take over existing financing.</li>
      <li><strong>Due-on-Sale Clause:</strong> Technically triggers lender's right to call the loan (rarely enforced if payments continue).</li>
    </ul>

    <h3>Why Sellers Accept Subject-To Deals</h3>
    <ul>
      <li><strong>Avoid Foreclosure:</strong> Seller facing foreclosure needs to transfer property quickly to save their credit.</li>
      <li><strong>Stop Negative Cash Flow:</strong> Rental property losing money monthly - seller wants out from payments.</li>
      <li><strong>Job Relocation:</strong> Need to move quickly, can't afford two mortgages, haven't sold yet.</li>
      <li><strong>Divorce/Estate:</strong> Need to divide assets or settle estate - want quick sale without realtor fees.</li>
      <li><strong>Avoid Realtor Commissions:</strong> Save 6% ($18,000 on $300,000 house) by not listing with agent.</li>
      <li><strong>Behind on Payments:</strong> Seller is several months behind - you catch up arrears and take over payments.</li>
    </ul>

    <h3>Advantages for Investors</h3>
    <ul>
      <li><strong>Little or No Money Down:</strong> Often acquire properties with just equity payment and arrears (if any).</li>
      <li><strong>No Bank Qualification:</strong> Don't need good credit, debt-to-income ratios, or bank approval.</li>
      <li><strong>Existing Interest Rate:</strong> Take over low-rate mortgages (valuable when rates are high).</li>
      <li><strong>Fast Closing:</strong> Close in days vs 30-45 days for traditional financing.</li>
      <li><strong>Built-In Financing:</strong> Leverage existing mortgage - don't tie up your capital or credit.</li>
      <li><strong>Instant Cash Flow:</strong> If rent exceeds PITI (principal, interest, taxes, insurance), profit immediately.</li>
      <li><strong>Multiple Exit Strategies:</strong> Rent, lease-option, flip, or refinance later.</li>
    </ul>

    <h3>Risks & Legal Considerations</h3>
    <ul>
      <li><strong>Due-on-Sale Clause:</strong> Lender can call the loan due when ownership transfers (rarely happens if payments current).</li>
      <li><strong>Seller Credit Impact:</strong> If you miss payments, damages seller's credit - creates ethical and legal liability.</li>
      <li><strong>Mortgage Insurance:</strong> Some insurance policies require owner-occupancy - coverage may lapse.</li>
      <li><strong>Title Issues:</strong> Proper documentation and disclosure required - use attorney to structure deal.</li>
      <li><strong>Foreclosure Risk:</strong> If seller files bankruptcy or has other liens, could complicate your ownership.</li>
      <li><strong>Tax Implications:</strong> Seller may still be liable for capital gains when you eventually sell.</li>
    </ul>

    <h3>Protecting All Parties</h3>
    <ul>
      <li><strong>Title Insurance:</strong> Get title insurance policy to protect against title defects and liens.</li>
      <li><strong>Authorization to Release:</strong> Seller signs form allowing lender to discuss loan with you.</li>
      <li><strong>Payment Verification System:</strong> Use third-party servicer or set up direct lender payments you can track.</li>
      <li><strong>Insurance Naming:</strong> Add yourself as additional insured on homeowner's policy or get your own landlord policy.</li>
      <li><strong>Written Agreement:</strong> Detailed contract outlining all terms, responsibilities, and contingencies.</li>
      <li><strong>Attorney Review:</strong> Have real estate attorney structure the deal properly for your state.</li>
    </ul>

    <h3>Deal Structures & Variations</h3>
    <ul>
      <li><strong>Full Subject-To:</strong> Take property subject to existing mortgage, pay seller's equity over time.</li>
      <li><strong>Subject-To with Wrap:</strong> Create wrap-around mortgage giving seller payments while you control property.</li>
      <li><strong>Subject-To with Cash:</strong> Pay seller's equity upfront in cash, take over payments.</li>
      <li><strong>Subject-To with Note:</strong> Give seller promissory note for equity, pay over 3-10 years.</li>
      <li><strong>Lease-Option to Subject-To:</strong> Start with lease-option, convert to subject-to after tenant qualifies.</li>
    </ul>

    <h3>Finding Subject-To Opportunities</h3>
    <ul>
      <li><strong>Pre-Foreclosure Lists:</strong> Contact homeowners facing foreclosure before auction.</li>
      <li><strong>FSBO (For Sale By Owner):</strong> Motivated sellers already avoiding realtors - open to creative financing.</li>
      <li><strong>Expired Listings:</strong> Properties that didn't sell after 90+ days - sellers may be desperate.</li>
      <li><strong>Direct Mail Campaigns:</strong> Target absentee owners, code violations, tax delinquencies.</li>
      <li><strong>Probate/Estate Sales:</strong> Heirs want to liquidate quickly without hassle.</li>
      <li><strong>Divorce Situations:</strong> Couples need to divide assets quickly - motivated to solve problem.</li>
    </ul>

    <h3>Exit Strategies</h3>
    <ul>
      <li><strong>Rental Hold:</strong> Keep as rental property, cash flow pays existing mortgage.</li>
      <li><strong>Lease-Option:</strong> Lease to tenant-buyer with option to purchase - collect option fee and premium rent.</li>
      <li><strong>Refinance & Cash Out:</strong> After 12-24 months, refinance in your name and pay off original mortgage.</li>
      <li><strong>Wholesale:</strong> Assign contract to another investor before closing for assignment fee.</li>
      <li><strong>Fix & Flip:</strong> Renovate and sell for profit (pay off subject-to mortgage at closing).</li>
      <li><strong>Owner Finance to End Buyer:</strong> Sell with owner financing, use proceeds to pay off subject-to mortgage.</li>
    </ul>

    <h3>Sample Deal Example</h3>
    <ul>
      <li>**Property Value:** $250,000</li>
      <li>**Existing Mortgage:** $220,000 at 4.5% ($1,115/month PITI)</li>
      <li>**Seller Equity:** $30,000</li>
      <li>**Your Offer:** Take property subject-to, pay seller $10,000 now, $20,000 when you refinance in 2 years</li>
      <li>**Market Rent:** $1,800/month</li>
      <li>**Cash Flow:** $685/month profit ($1,800 rent - $1,115 payment)</li>
      <li>**Cash Invested:** $10,000 (seller equity payment)</li>
      <li>**Annual Cash Flow:** $8,220</li>
      <li>**Cash-on-Cash Return:** 82.2% ($8,220 / $10,000)</li>
    </ul>

    <h3>Due Diligence Checklist</h3>
    <ul>
      <li><strong>Verify Loan Status:</strong> Get payoff statement, confirm payment history, check for missed payments.</li>
      <li><strong>Review Loan Terms:</strong> Interest rate, payment amount, remaining balance, prepayment penalties.</li>
      <li><strong>Title Search:</strong> Check for liens, judgments, back taxes, or other encumbrances.</li>
      <li><strong>Property Inspection:</strong> Assess condition, needed repairs, deferred maintenance costs.</li>
      <li><strong>Insurance Verification:</strong> Confirm coverage, determine if you need separate landlord policy.</li>
      <li><strong>HOA/Condo Docs:</strong> Review association rules, fees, special assessments if applicable.</li>
      <li><strong>Seller Background:</strong> Verify seller owns property, has authority to transfer, not in bankruptcy.</li>
    </ul>

    <h3>How to Use This Calculator</h3>
    <p>Enter the property value, existing mortgage balance, mortgage payment, interest rate, seller equity payment, expected rental income, and monthly expenses. The calculator shows your monthly cash flow, cash-on-cash return, break-even analysis, and total returns to help you evaluate the subject-to investment opportunity.</p>
  `,
  },
  calculator: {
    fields: [
      {
        name: 'propertyValue',
        label: 'Current Property Value ($)',
        type: 'number',
        defaultValue: 250000,
      },
      {
        name: 'mortgageBalance',
        label: 'Existing Mortgage Balance ($)',
        type: 'number',
        defaultValue: 220000,
      },
      {
        name: 'monthlyPayment',
        label: 'Monthly Mortgage Payment (PITI) ($)',
        type: 'number',
        defaultValue: 1115,
      },
      {
        name: 'interestRate',
        label: 'Existing Mortgage Interest Rate (%)',
        type: 'number',
        defaultValue: 4.5,
      },
      {
        name: 'sellerEquityPayment',
        label: 'Cash Payment to Seller for Equity ($)',
        type: 'number',
        defaultValue: 10000,
      },
      {
        name: 'monthlyRent',
        label: 'Expected Monthly Rental Income ($)',
        type: 'number',
        defaultValue: 1800,
      },
      {
        name: 'monthlyExpenses',
        label: 'Monthly Expenses (Maintenance, Vacancy, etc.) ($)',
        type: 'number',
        defaultValue: 200,
      },
      {
        name: 'holdingPeriod',
        label: 'Expected Holding Period (Years)',
        type: 'number',
        defaultValue: 3,
      },
    ],
    results: [],
    calculate: (values) => {
      const { propertyValue, mortgageBalance, monthlyPayment, interestRate, sellerEquityPayment, monthlyRent, monthlyExpenses, holdingPeriod } = values;
      
      const sellerEquity = propertyValue - mortgageBalance;
      const yourEquity = sellerEquity - sellerEquityPayment;
      const loanToValue = (mortgageBalance / propertyValue) * 100;
      
      const monthlyNetIncome = monthlyRent - monthlyPayment - monthlyExpenses;
      const annualCashFlow = monthlyNetIncome * 12;
      const totalCashFlow = annualCashFlow * holdingPeriod;
      
      const cashOnCash = sellerEquityPayment > 0 ? (annualCashFlow / sellerEquityPayment) * 100 : 0;
      
      const monthlyRate = interestRate / 100 / 12;
      const paymentsRemaining = holdingPeriod * 12;
      let principalPaid = 0;
      let remainingBalance = mortgageBalance;
      
      for (let month = 1; month <= paymentsRemaining; month++) {
        const interestPayment = remainingBalance * monthlyRate;
        const principalPayment = monthlyPayment - interestPayment;
        principalPaid += principalPayment;
        remainingBalance -= principalPayment;
      }
      
      const equityGain = principalPaid;
      const totalReturn = totalCashFlow + equityGain;
      const totalROI = sellerEquityPayment > 0 ? (totalReturn / sellerEquityPayment) * 100 : 0;
      
      const breakEvenMonths = sellerEquityPayment > 0 && monthlyNetIncome > 0 ? sellerEquityPayment / monthlyNetIncome : 0;

      return [
        { label: 'Property Value', value: propertyValue.toFixed(2), isCurrency: true },
        { label: 'Existing Mortgage Balance', value: mortgageBalance.toFixed(2), isCurrency: true },
        { label: 'Loan-to-Value (LTV)', value: `${loanToValue.toFixed(2)}%` },
        { label: 'Seller Equity', value: sellerEquity.toFixed(2), isCurrency: true },
        { label: 'Your Equity Payment to Seller', value: sellerEquityPayment.toFixed(2), isCurrency: true },
        { label: 'Your Instant Equity', value: yourEquity.toFixed(2), isCurrency: true },
        { label: 'Monthly Cash Flow', value: monthlyNetIncome.toFixed(2), isCurrency: true },
        { label: 'Annual Cash Flow', value: annualCashFlow.toFixed(2), isCurrency: true },
        { label: `Total Cash Flow (${holdingPeriod} Years)`, value: totalCashFlow.toFixed(2), isCurrency: true },
        { label: 'Cash-on-Cash Return', value: `${cashOnCash.toFixed(2)}%` },
        { label: `Principal Paid Down (${holdingPeriod} Years)`, value: principalPaid.toFixed(2), isCurrency: true },
        { label: 'Total Return (Cash Flow + Equity)', value: totalReturn.toFixed(2), isCurrency: true },
        { label: 'Total ROI', value: `${totalROI.toFixed(2)}%` },
        { label: 'Break-Even Period', value: `${breakEvenMonths.toFixed(1)} months` },
      ];
    },
  },
};
